 This article was first published on R for Public Health and kindly contributed to R bloggers In the last post I went over the basics of lists including constructing manipulating and converting lists to other classes Knowing the basics in this post we ll use the apply functions to see just how powerful working with lists can be I ve done two posts on apply for dataframes and matrics here and here so give those a read if you need a refresher There are a variety of apply based functions that can be used depending on what you want to do The table below shows the function what it inputs and what it outputs For example if you have a list and you want to produce a vector of the same length use sapply If you have a vector and want to produce a list of the same length use lapply Let s try an example The syntax of lapply is lapply INPUT function x Some function here where INPUT as we see from the table above must be a vector or a list and function x is any kind of function that takeseach element of the INPUT and applies the function to it The function can be something that already exists in R or it can be a new function that you ve written up For example let s construct a list of 3 vectors like so and now we can use lapply to find the mean of each element of the list mean of each of the vectors x y and z and output to a new list But let s say we wanted the result in a vector not in a list for whatever reason Instead of doing the above and then converting the list into a vector using unlist or ldply or whatever we can do this directly using sapply instead oflapply That s because as you can see in table sapply can take in a list as the input and it will return a vector or matrix Let s try it This is really great Anytime you want to do the same thing over and over again put all those things in a list and then use one of the apply functions This reduces the need to run a loop which can take a lot longer Let s do another example where we write our own function this time You don t need to have a list already created to use lapply in fact lapply can be used to make a list This is because the key about lapply is that it returns a list of the same length as whatever you input For example let s initialize a list to have 2 empty matrices that are size 2 3 We ll use lapply our input is just a vector containing 1 and 2 and the function we specify uses the matrix function to construct a 2 3 matrix of empty cells for each element of this vector so it returns a list of two such matrices If instead of empty matrices we wanted to fill these matrices with random numbers we could do that too Check out both possibilities below Again we can use lapply or sapply on this newly created list to get the sum of each column of each matrix Finally what are lists good for Often I find a lists are great when I want to store multi dimensional objects into one object for example group a bunch of data frames into a list or store all my model results into one list Here s an example where I run four linear models for four different outcomes I want to store all my models into one object There are two ways to do this Now I want to run each of the four outcomes on the trt variable using linear regression and save the results I ll do this first as a loop then using lapply In the second case we are taking the vector c 2 3 4 5 and for each component of this vector we re running the model that we describe in the function We can always name the components of the list as below and I ll print out the first two elements Why is this a great way to store data Well we can keep using the apply functions for example to put together all of the treatment effects for each outcome into one matrix You can also easily use other functions like stargazer previous post on this function here to create a quick table of results like so in latex code Or easily create a graph of the model estimates and 95 confidence intervals I hope that was useful There are many great ways to use lists and the apply functions to make your programming more efficient and less prone to errors For another great resource on using the apply functions with lists definitely check out this StackOverflow page To leave a comment for the author please follow the link and comment on their blog R for Public Health R bloggers com offers daily e mail updates about R news and tutorials on topics such as Data science Big Data R jobs visualization ggplot2 Boxplots maps animation programming RStudio Sweave LaTeX SQL Eclipse git hadoop Web Scraping statistics regression PCA time series trading and more Comments are closed 